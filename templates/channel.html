<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Channel - YStube</title>
    <style>
        :root {
            --accent: #00d4ff;
            --bg: #05070a;
            --panel: rgba(255, 255, 255, 0.05);
            --border: rgba(255, 255, 255, 0.1);
            --text-main: #ffffff;
            --text-sub: #aaaaaa;
        }
        body {
            margin: 0; background: var(--bg); color: var(--text-main);
            font-family: "YouTube Sans", "Roboto", sans-serif;
        }
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        
        .channel-header {
            display: flex; align-items: center; gap: 20px; padding: 40px 0;
            border-bottom: 1px solid var(--border); margin-bottom: 30px;
        }
        .ch-icon { width: 120px; height: 120px; border-radius: 50%; object-fit: cover; background: var(--panel); }
        .ch-name { font-size: 2rem; font-weight: bold; margin: 0; }
        
        .video-grid {
            display: grid; grid-template-columns: repeat(auto-fill, minmax(240px, 1fr)); gap: 20px;
        }
        .v-card { text-decoration: none; color: inherit; transition: transform 0.2s; }
        .v-card:hover { transform: translateY(-5px); }
        .v-thumb { 
            width: 100%; aspect-ratio: 16/9; border-radius: 12px; object-fit: cover; 
            background: var(--panel); margin-bottom: 8px;
        }
        .v-title { font-size: 0.95rem; font-weight: bold; line-height: 1.4; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
        .v-meta { font-size: 0.8rem; color: var(--text-sub); margin-top: 4px; }
    </style>
</head>
<body>
    <div class="container">
        <div class="channel-header">
            <img id="ch-icon" src="" class="ch-icon">
            <div class="ch-info">
                <h1 id="ch-name" class="ch-name">Loading...</h1>
                <p id="ch-id" style="color:var(--text-sub); margin: 5px 0;"></p>
            </div>
        </div>

        <div class="video-grid" id="video-grid"></div>
    </div>

    <script>
        const chId = "{{ channel_id }}";
        async function loadChannel() {
            try {
                const res = await fetch(`/api/channel/${chId}`);
                const data = await res.json();

                document.getElementById('ch-name').innerText = data.name;
                document.getElementById('ch-id').innerText = data.channel_id;
                document.getElementById('ch-icon').src = data.icon || 'https://www.youtube.com/img/desktop/ftbc/default_avatar.png';

                const grid = document.getElementById('video-grid');
                grid.innerHTML = data.videos.map(v => `
                    <a href="/watch?v=${v.id}" class="v-card">
                        <img src="https://img.youtube.com/vi/${v.id}/mqdefault.jpg" class="v-thumb">
                        <div class="v-title">${v.title}</div>
                        <div class="v-meta">${v.view_count.toLocaleString()} views</div>
                    </a>
                `).join('');
            } catch (e) { console.error(e); }
        }
        loadChannel();
    </script>
</body>
</html>
